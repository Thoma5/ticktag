<div class="row">
  <div class="col-md-5 filter">
    <div class="form-group" [ngClass]="{'has-error has-feedback': error===true}">
      <div class="input-group">
        <span class="input-group-btn">
          <button class="btn btn-default" [ngClass]="{'btn-danger': error===true}" (click)="filterHelper=!filterHelper">
            <i class="glyphicon glyphicon-filter" ></i></button>
        </span>
        <input #filterInput id="filterInput" type="text" class="form-control" [(ngModel)]=query (input)=debounce(filterInput.value)>
      </div>
      <i [ngClass]="{'glyphicon glyphicon-remove form-control-feedback filter-error': error===true}"></i>
    </div>
  </div>
  <md-card *ngIf="error" class="col-md-5 filter-error-card">
    <label tooltip="{{errorMsg}}" tooltipPlacement="bottom" tooltipTrigger="mouseenter" class="control-label filter-error-label"
      for="filterInput"><i class="glyphicon glyphicon-warning-sign"></i><b> Errors: </b>{{errorMsg}}</label>
  </md-card>
</div>
<div *ngIf="filterHelper" class="row">
  <div class="col-md-6 filterHelper">
    <div class="btn-group" dropdown keyboardNav="true">
      <button id="simple-btn-keyboard-nav" type="button" class="btn btn-default  btn-sm" dropdownToggle>
        <i class="glyphicon glyphicon-tag" ></i> Tags <span class="caret"></span>
    </button>
      <ul class="dropdown-menu" dropdownMenu role="menu" aria-labelledby="simple-btn-keyboard-nav">
        <li role="menuitem" *ngFor="let tag of tags">
          <a (click)="pickTag(tag.normalizedName)" class="dropdown-item">
            <div class="tag" [style.backgroundColor]="'#' + tag.color">
              <span class="name">{{ tag.name }}</span>
            </div>
            ({{tag.normalizedName}})
          </a>
        </li>
      </ul>
    </div>
    <div class="btn-group" dropdown keyboardNav="true">
      <button id="simple-btn-keyboard-nav" type="button" class="btn btn-default btn-sm" dropdownToggle>
        <i class="glyphicon glyphicon-user"></i> Assignees <span class="caret"></span>
    </button>
      <ul class="dropdown-menu" dropdownMenu role="menu" aria-labelledby="simple-btn-keyboard-nav">
        <li role="menuitem" *ngFor="let user of assignees"><a (click)="pickUser(user.username)" class="dropdown-item">{{user.name}} ({{user.username}})</a></li>
      </ul>
    </div>
    <div class="btn-group" dropdown keyboardNav="true" autoClose="outsideClick">
      <button id="simple-btn-keyboard-nav" type="button" class="btn btn-default  btn-sm" dropdownToggle>
        <i class="glyphicon glyphicon-calendar" ></i> Due Date <span class="caret"></span>
    </button>
      <div class="dropdown-menu" dropdownMenu role="menu" aria-labelledby="simple-btn-keyboard-nav">
        <form>
          <div class="form-group">
            <label *ngIf="dateMode.value !== '- Between'">Date:</label>
            <label *ngIf="dateMode.value === '- Between'">Date From:</label>
            <div class="form-group">
              <div class="input-group">
                <input [(ngModel)]=datePickOne name="datePickOne" id="filterInput" type="text" class="form-control" placeholder="YYYY-MM-DD"
                  required>
                <span class="input-group-btn">
                  <button class="btn btn-default">
                  <i class="glyphicon glyphicon-calendar" ></i></button>                    
                </span>
              </div>
            </div>
          </div>
          <div class="form-group" *ngIf="dateMode.value === '- Between'">
            <label>Date To:</label>
            <div class="form-group">
              <div class="input-group">
                <input [(ngModel)]=datePickTwo name="datePickTwo" id="filterInput" type="text" class="form-control" placeholder="YYYY-MM-DD"
                  required>
                <span class="input-group-btn">
                  <button class="btn btn-default">
                  <i class="glyphicon glyphicon-calendar" ></i></button>                    
                </span>
              </div>
            </div>
          </div>
          <div class="divider dropdown-divider"></div>
          <select #dateMode class="form-control" id="sel1">
            <option>< Smaller Than</option>
            <option>= Equals</option>
            <option>> Greater Than</option>
            <option>- Between</option>
          </select>
          <div class="divider dropdown-divider"></div>
          <button type="submit" class="btn btn-success" (click)="pickDate(dateMode.value.charAt(0))" [disabled]="(datePickOne === undefined || datePickOne === '') || dateMode.value === '- Between' && (datePickTwo === undefined || datePickTwo === '')">Select</button>
        </form>
      </div>
    </div>
    <div class="btn-group" dropdown keyboardNav="true" autoClose="outsideClick">
      <button id="simple-btn-keyboard-nav" type="button" class="btn btn-default  btn-sm" dropdownToggle>
        <i class="glyphicon glyphicon-scale" ></i> Story Points <span class="caret"></span>
    </button>
      <div class="dropdown-menu" dropdownMenu role="menu" aria-labelledby="simple-btn-keyboard-nav">
        <form>
          <div class="form-group">
            <label *ngIf="spMode.value !== '- Between'">Story Points:</label>
            <label *ngIf="spMode.value === '- Between'">Story Points From:</label>
            <div class="form-group">
              <input [(ngModel)]=spPickOne name="spPickOne" id="filterInput" type="number" class="form-control" placeholder="0" required>
            </div>
          </div>
          <div class="form-group" *ngIf="spMode.value === '- Between'">
            <label>Story Points To:</label>
            <div class="form-group">
              <input [(ngModel)]=spPickTwo name="spPickTwo" id="filterInput" type="number" class="form-control" placeholder="0" required>
            </div>
          </div>
          <div class="divider dropdown-divider"></div>
          <select #spMode class="form-control" id="sel1">
            <option>< Smaller Than</option>
            <option>= Equals</option>
            <option>> Greater Than</option>
            <option>- Between</option>
          </select>
          <div class="divider dropdown-divider"></div>
          <button type="submit" class="btn btn-success" (click)="pickSP(spMode.value.charAt(0))" [disabled]="(spPickOne === undefined || spPickOne === '') || spMode.value === '- Between' && (spPickTwo === undefined || spPickTwo === '')">Select</button>
        </form>
      </div>
    </div>
    <div class="btn-group" dropdown keyboardNav="true" autoClose="outsideClick">
      <button id="simple-btn-keyboard-nav" type="button" class="btn btn-default btn-sm" dropdownToggle>
        <b>%</b> Progress <span class="caret"></span>
    </button>
      <div class="dropdown-menu" dropdownMenu role="menu" aria-labelledby="simple-btn-keyboard-nav">
        <form>
          <div class="form-group">
            <label *ngIf="progressMode.value !== '- Between'">Progress:</label>
            <label *ngIf="progressMode.value === '- Between'">Progress From:</label>
            <div class="form-group">
              <div class="input-group">
                <input [(ngModel)]=progressPickOne name="progressPickOne" id="filterInput" type="number" class="form-control" placeholder="0"
                  required>
                <span class="input-group-addon">
                  %                 
                </span>
              </div>
            </div>
          </div>
          <div class="form-group" *ngIf="progressMode.value === '- Between'">
            <label>Progress To:</label>
            <div class="form-group">
              <div class="input-group">
                <input [(ngModel)]=progressPickTwo name="progressPickTwo" id="filterInput" type="number" class="form-control" placeholder="0"
                  required>
                <span class="input-group-addon">
                  %            
                </span>
              </div>
            </div>
          </div>
          <div class="divider dropdown-divider"></div>
          <select #progressMode class="form-control" id="sel1">
            <option>< Smaller Than</option>
            <option>= Equals</option>
            <option>> Greater Than</option>
            <option>- Between</option>
          </select>
          <div class="divider dropdown-divider"></div>
          <button type="submit" class="btn btn-success" (click)="pickProgress(progressMode.value.charAt(0))"  [disabled]="(progressPickOne === undefined || progressPickOne === '') || progressMode.value === '- Between' && (progressPickTwo === undefined || progressPickTwo === '')">Select</button>
        </form>
      </div>
    </div>
     <div class="btn-group" dropdown keyboardNav="true">
      <button id="simple-btn-keyboard-nav" type="button" class="btn btn-default btn-sm" dropdownToggle>
        <i class="glyphicon glyphicon-ok" ></i> Status <span class="caret"></span>
    </button>
     <ul dropdownMenu role="menu" aria-labelledby="single-button">
      <li role="menuitem"><a (click)="pickStatus(true)" class="dropdown-item"> <i class="glyphicon glyphicon-unchecked" ></i> Open</a></li>
      <li role="menuitem"><a (click)="pickStatus(false)" class="dropdown-item"> <i class="glyphicon glyphicon-check" ></i> Closed</a></li>
      <li role="menuitem"><a (click)="pickStatus(undefined)" class="dropdown-item"><i class="glyphicon glyphicon-collapse-down" ></i> All</a></li>
    </ul>

  </div>
</div>
